{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "import seaborn as sns\n",
    "\n",
    "from sklearn.datasets import load_iris \n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.preprocessing import OneHotEncoder\n",
    "from sklearn.metrics import confusion_matrix\n",
    "\n",
    "X, y = load_iris(return_X_y = True, as_frame = True)\n",
    "\n",
    "X = np.array(X)\n",
    "\n",
    "sc = StandardScaler()\n",
    "X = sc.fit_transform(X)\n",
    "\n",
    "y = np.array(y).reshape(-1, 1)\n",
    "ohe = OneHotEncoder()\n",
    "y = ohe.fit_transform(y).toarray()\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "def sigmoid(x):\n",
    "    return 1.0/(1.0 + np.exp(-x))\n",
    " \n",
    "def sigmoid_derivada(x):\n",
    "    return sigmoid(x)*(1.0-sigmoid(x))\n",
    " \n",
    "\n",
    "class NeuralNetwork:\n",
    " \n",
    "    def __init__(self, layers):\n",
    "        self.activation = sigmoid\n",
    "        self.activation_prime = sigmoid_derivada\n",
    " \n",
    "        self.weights = []\n",
    "        self.deltas = []\n",
    "\n",
    "        for i in range(1, len(layers) - 1):\n",
    "            r = 2*np.random.random((layers[i-1] + 1, layers[i] + 1)) - 1\n",
    "            self.weights.append(r)\n",
    "        r = 2*np.random.random( (layers[i] + 1, layers[i+1])) - 1\n",
    "        self.weights.append(r)\n",
    " \n",
    "    def fit(self, X, y, learning_rate=0.2, epochs=100000):\n",
    "        \n",
    "        ones = np.atleast_2d(np.ones(X.shape[0]))\n",
    "        X = np.concatenate((ones.T, X), axis=1)\n",
    "        \n",
    "        for k in range(epochs):\n",
    "            i = np.random.randint(X.shape[0])\n",
    "            a = [X[i]]\n",
    " \n",
    "            for l in range(len(self.weights)):\n",
    "                dot_value = np.dot(a[l], self.weights[l])\n",
    "                activation = self.activation(dot_value)\n",
    "                a.append(activation)\n",
    "        \n",
    "            error = y[i] - a[-1]\n",
    "            deltas = [error * self.activation_prime(a[-1])]\n",
    "            \n",
    "            for l in range(len(a) - 2, 0, -1): \n",
    "                deltas.append(deltas[-1].dot(self.weights[l].T)*self.activation_prime(a[l]))\n",
    "            self.deltas.append(deltas)\n",
    " \n",
    "            deltas.reverse()\n",
    "\n",
    "            for i in range(len(self.weights)):\n",
    "                layer = np.atleast_2d(a[i])\n",
    "                delta = np.atleast_2d(deltas[i])\n",
    "                self.weights[i] += learning_rate * layer.T.dot(delta)\n",
    " \n",
    "            if k % 10000 == 0: print('epochs:', k)\n",
    " \n",
    "    def predict(self, x): \n",
    "        ones = np.atleast_2d(np.ones(x.shape[0]))\n",
    "        a = np.concatenate((np.ones(1).T, np.array(x)), axis=0)\n",
    "        for l in range(0, len(self.weights)):\n",
    "            a = self.activation(np.dot(a, self.weights[l]))\n",
    "        a = list(a).index(max(a)) + 1\n",
    "        return a\n",
    "    \n",
    "    def acc(self, y, y_pred): \n",
    "        acum = 0\n",
    "        for i in range(len(y)):\n",
    "            if y[i] == y_pred[i]:\n",
    "                acum += 1\n",
    "        return acum/len(y)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "epochs: 0\n",
      "epochs: 10000\n",
      "ACC:  0.9666666666666667\n"
     ]
    }
   ],
   "source": [
    "nn = NeuralNetwork([4,40,3])\n",
    "\n",
    "nn.fit(X_train, y_train, learning_rate=0.05,epochs=15001)\n",
    " \n",
    "index=0\n",
    "y_pred = []\n",
    "for e in X_test:\n",
    "    y_pred.append(nn.predict(e))\n",
    "    index=index+1\n",
    "\n",
    "y_test_normal = []\n",
    "for e in y_test:\n",
    "    y_test_normal.append(list(e).index(max(e)) + 1) \n",
    "\n",
    "print(\"ACC: \", nn.acc(y_test_normal, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<Figure size 640x480 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "cm = confusion_matrix(y_test_normal, y_pred)\n",
    "\n",
    "sns.heatmap(confusion_matrix(y_test_normal, y_pred),     \n",
    "    annot=True)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "base",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
